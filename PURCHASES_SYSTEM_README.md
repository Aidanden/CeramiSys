# نظام إدارة المشتريات - CeramiSys

## نظرة عامة
تم إنشاء نظام إدارة المشتريات بنجاح وربطه بالباك إند والفرونت إند. يتضمن النظام إدارة فواتير المشتريات والموردين والمدفوعات.

## الميزات المنجزة

### 1. الباك إند (Backend)
- ✅ **PurchaseController**: إدارة فواتير المشتريات
- ✅ **PurchaseService**: منطق العمل للمشتريات
- ✅ **Purchase Routes**: API endpoints للمشتريات
- ✅ **Supplier Management**: إدارة الموردين
- ✅ **Payment Management**: إدارة مدفوعات المشتريات
- ✅ **Database Integration**: ربط بقاعدة البيانات Prisma

### 2. الفرونت إند (Frontend)
- ✅ **صفحة المشتريات الرئيسية**: عرض قائمة فواتير المشتريات
- ✅ **إحصائيات المشتريات**: عرض الإحصائيات الأساسية
- ✅ **فلترة وبحث**: إمكانية البحث والفلترة
- ✅ **إنشاء فاتورة مشتريات**: نموذج إنشاء فاتورة جديدة
- ✅ **إدارة الموردين**: إضافة وتعديل الموردين
- ✅ **عرض تفاصيل الفاتورة**: عرض تفاصيل كاملة للفاتورة
- ✅ **إدارة المدفوعات**: إضافة مدفوعات للفواتير الآجلة

### 3. المكونات (Components)
- ✅ **CreatePurchaseModal**: نموذج إنشاء فاتورة مشتريات
- ✅ **CreateSupplierModal**: نموذج إضافة مورد جديد
- ✅ **PurchaseDetailsModal**: عرض تفاصيل الفاتورة
- ✅ **AddPaymentModal**: نموذج إضافة دفعة

### 4. التكامل (Integration)
- ✅ **RTK Query**: ربط API بالفرونت إند
- ✅ **Redux Store**: إدارة الحالة
- ✅ **Sidebar Integration**: إضافة رابط المشتريات في السايد بار
- ✅ **Arabic Support**: دعم اللغة العربية

## API Endpoints

### المشتريات (Purchases)
```
POST   /api/purchases              - إنشاء فاتورة مشتريات جديدة
GET    /api/purchases              - جلب قائمة فواتير المشتريات
GET    /api/purchases/:id          - جلب فاتورة مشتريات محددة
PUT    /api/purchases/:id          - تحديث فاتورة مشتريات
DELETE /api/purchases/:id          - حذف فاتورة مشتريات
GET    /api/purchases/stats        - إحصائيات المشتريات
```

### الموردين (Suppliers)
```
POST   /api/suppliers              - إنشاء مورد جديد
GET    /api/suppliers              - جلب قائمة الموردين
GET    /api/suppliers/:id          - جلب مورد محدد
PUT    /api/suppliers/:id          - تحديث مورد
DELETE /api/suppliers/:id          - حذف مورد
```

### مدفوعات المشتريات (Purchase Payments)
```
POST   /api/purchases/payments     - إضافة دفعة لفاتورة مشتريات
```

## الصلاحيات (Permissions)
- **admin**: جميع الصلاحيات
- **manager**: إدارة المشتريات والموردين
- **purchase_manager**: إدارة المشتريات والموردين
- **viewer**: عرض المشتريات فقط

## أنواع المشتريات
- **نقدي (CASH)**: دفع فوري
- **آجل (CREDIT)**: دفع لاحق

## طرق الدفع
- **نقد (CASH)**
- **بنك (BANK)**
- **بطاقة (CARD)**

## الميزات المتقدمة
- **تحديث المخزن**: تحديث تلقائي للمخزن عند إنشاء فاتورة مشتريات
- **إدارة المدفوعات**: إمكانية إضافة مدفوعات جزئية للفواتير الآجلة
- **البحث والفلترة**: بحث متقدم حسب المورد، النوع، حالة السداد
- **التصفح**: تصفح الصفحات مع عرض عدد النتائج
- **التصدير**: إمكانية تصدير البيانات (قيد التطوير)

## كيفية الاستخدام

### 1. الوصول لشاشة المشتريات
- من السايد بار، اضغط على "المشتريات"
- تأكد من اختيار الشركة أولاً

### 2. إنشاء فاتورة مشتريات جديدة
- اضغط على "فاتورة مشتريات جديدة"
- اختر المورد (أو أضف مورد جديد)
- أدخل رقم الفاتورة (اختياري)
- اختر نوع الشراء (نقدي/آجل)
- أضف الأصناف مع الكميات والأسعار
- اضغط "إنشاء الفاتورة"

### 3. إدارة الموردين
- اضغط على "مورد جديد" في شريط الفلترة
- أدخل بيانات المورد
- اضغط "إنشاء المورد"

### 4. عرض تفاصيل الفاتورة
- اضغط على أيقونة العين في جدول المشتريات
- ستظهر تفاصيل كاملة للفاتورة

### 5. إضافة دفعة
- للفواتير الآجلة غير المدفوعة بالكامل
- اضغط على أيقونة المال
- أدخل مبلغ الدفعة وطريقة الدفع
- اضغط "إضافة الدفعة"

## الملفات المهمة

### الباك إند
- `server/src/controllers/PurchaseController.ts`
- `server/src/services/PurchaseService.ts`
- `server/src/routes/purchaseRoutes.ts`
- `server/src/dto/purchaseDto.ts`

### الفرونت إند
- `client/src/app/purchases/page.tsx`
- `client/src/state/purchaseApi.ts`
- `client/src/components/purchases/`

### قاعدة البيانات
- `server/prisma/schema.prisma` (جداول Purchase, Supplier, PurchasePayment)

## التطوير المستقبلي
- [ ] تقارير المشتريات
- [ ] إشعارات المدفوعات المستحقة
- [ ] ربط مع نظام المحاسبة
- [ ] دعم العملات المتعددة
- [ ] تصدير البيانات بصيغ مختلفة
- [ ] إدارة المخزون المتقدم

## الدعم الفني
لأي استفسارات أو مشاكل، يرجى التواصل مع فريق التطوير.

---
**تم إنشاء النظام بنجاح بتاريخ:** ${new Date().toLocaleDateString('ar-LY')}
**الإصدار:** 1.0.0
**المطور:** CeramiSys Team

