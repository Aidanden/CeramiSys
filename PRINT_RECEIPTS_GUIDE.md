# 🖨️ دليل طباعة إيصالات القبض والدفعات

## ✅ ما تم إضافته:

### 1. مكونات الطباعة:
- ✅ **PaymentReceiptPrint.tsx**: إيصال قبض لدفعة واحدة (80mm)
- ✅ **PaymentsHistoryPrint.tsx**: سجل جميع الدفعات لفاتورة (A4)

### 2. الأزرار المضافة:
- ✅ زر 🖨️ بجانب كل دفعة لطباعة إيصال القبض
- ✅ زر "طباعة سجل الدفعات" في مودال التفاصيل
- ✅ طباعة تلقائية بعد إضافة دفعة جديدة

---

## 📋 كيفية الاستخدام:

### 1. طباعة إيصال قبض لدفعة:
1. افتح صفحة المبيعات الآجلة
2. اضغط على 👁️ لعرض تفاصيل الفاتورة
3. اضغط على 🖨️ بجانب أي دفعة
4. سيفتح نافذة الطباعة تلقائياً

### 2. طباعة سجل الدفعات:
1. افتح تفاصيل الفاتورة
2. اضغط على زر "🖨️ طباعة سجل الدفعات"
3. سيفتح نافذة الطباعة لسجل كامل

### 3. طباعة تلقائية بعد السداد:
1. أضف دفعة جديدة
2. بعد النجاح، ستفتح نافذة الطباعة تلقائياً
3. يمكنك الطباعة أو الإلغاء

---

## 🎨 تصميم الإيصالات:

### إيصال القبض (80mm):
- **الحجم**: 80mm (مناسب لطابعات الإيصالات الحرارية)
- **المحتوى**:
  - معلومات الشركة
  - رقم الإيصال والتاريخ
  - بيانات العميل
  - بيانات الفاتورة
  - تفاصيل الدفعة (مبلغ، طريقة دفع)
  - المبلغ المتبقي
  - ملخص مالي
  - توقيعات

### سجل الدفعات (A4):
- **الحجم**: A4 (مناسب للطابعات العادية)
- **المحتوى**:
  - معلومات الشركة
  - بيانات الفاتورة
  - جدول جميع الدفعات
  - ملخص مالي
  - حالة السداد
  - توقيعات (محاسب، مدير مالي، مدير عام)

---

## 🔧 التخصيص:

### تغيير معلومات الشركة:
في ملف `credit-sales/page.tsx`، ابحث عن:

```typescript
company={{
  name: 'اسم الشركة',
  address: 'عنوان الشركة',
  phone: 'رقم الهاتف'
}}
```

غيّر القيم حسب شركتك.

### تغيير حجم الإيصال:
في `PaymentReceiptPrint.tsx`:

```css
@page {
  size: 80mm auto; // غيّر إلى 58mm أو 80mm
  margin: 5mm;
}
```

---

## 📝 محتوى إيصال القبض:

### معلومات أساسية:
- رقم الإيصال (REC-YYYYMM-0001)
- التاريخ والوقت
- معلومات الشركة

### بيانات العميل:
- اسم العميل
- رقم الهاتف

### بيانات الفاتورة:
- رقم الفاتورة
- إجمالي الفاتورة
- المبلغ المدفوع سابقاً

### تفاصيل الدفعة:
- المبلغ المدفوع (بارز)
- طريقة الدفع
- ملاحظات

### ملخص:
- إجمالي الفاتورة
- إجمالي المدفوع
- المبلغ المتبقي

---

## 📊 محتوى سجل الدفعات:

### جدول الدفعات:
| # | رقم الإيصال | التاريخ | المبلغ | طريقة الدفع | ملاحظات |
|---|-------------|---------|--------|-------------|---------|
| 1 | REC-202510-0001 | 01/10/2025 | 500.00 د.ل | كاش | - |
| 2 | REC-202510-0002 | 05/10/2025 | 300.00 د.ل | حوالة | - |

### الملخص المالي:
- إجمالي الفاتورة
- المبلغ المدفوع
- المبلغ المتبقي

### حالة السداد:
- ✓ تم السداد بالكامل (أخضر)
- ⚠ يوجد مبلغ متبقي (أصفر)

---

## 🎯 المميزات:

### 1. تصميم احترافي:
- ✅ ألوان مناسبة ومنظمة
- ✅ خطوط واضحة وقابلة للقراءة
- ✅ تنسيق RTL كامل

### 2. معلومات شاملة:
- ✅ جميع التفاصيل المطلوبة
- ✅ أرقام عربية
- ✅ عملة ليبية (د.ل)

### 3. سهولة الاستخدام:
- ✅ طباعة بضغطة زر واحدة
- ✅ طباعة تلقائية بعد السداد
- ✅ معاينة قبل الطباعة

### 4. متوافق مع الطابعات:
- ✅ طابعات حرارية 80mm
- ✅ طابعات عادية A4
- ✅ طباعة PDF

---

## 🔍 استكشاف الأخطاء:

### المشكلة: نافذة الطباعة لا تفتح
**الحل**: تأكد من السماح بالنوافذ المنبثقة في المتصفح

### المشكلة: التنسيق غير صحيح
**الحل**: تأكد من استخدام متصفح حديث (Chrome, Edge)

### المشكلة: الأرقام غير عربية
**الحل**: تحقق من إعدادات `toLocaleString('ar-LY')`

---

## 📱 التوافق:

### المتصفحات:
- ✅ Chrome
- ✅ Edge
- ✅ Firefox
- ✅ Safari

### الطابعات:
- ✅ طابعات حرارية (80mm, 58mm)
- ✅ طابعات ليزر A4
- ✅ طابعات نفث الحبر
- ✅ طباعة PDF

---

## 🚀 التطويرات المستقبلية:

1. إضافة شعار الشركة
2. باركود لرقم الإيصال
3. طباعة نسختين (أصل + صورة)
4. حفظ PDF تلقائياً
5. إرسال بالبريد الإلكتروني

---

## ✅ الخلاصة:

تم إضافة نظام طباعة كامل للمبيعات الآجلة يشمل:
- ✅ إيصالات قبض احترافية
- ✅ سجل دفعات شامل
- ✅ طباعة تلقائية بعد السداد
- ✅ تصميم عربي RTL
- ✅ متوافق مع جميع الطابعات

**النظام جاهز للاستخدام! 🎉**
