# ุฅุถุงูุฉ ุงุฎุชูุงุฑ ุงูุดุฑูุฉ ุงููุฑุนูุฉ ูู ุงููุจูุนุงุช ุงููุนูุฏุฉ

## ๐ฏ ุงููุดููุฉ:
ูุงู ุงููุธุงู ูุณุชุฎุฏู `currentCompanyId` (ุดุฑูุฉ ุงููุณุชุฎุฏู ุงูุญุงูู) ุชููุงุฆูุงูุ ููู ุงููุทููุจ ูู **ุงูุณูุงุญ ูููุณุชุฎุฏู ุจุงุฎุชูุงุฑ ุงูุดุฑูุฉ ุงููุฑุนูุฉ** ุงูุชู ุณุชุณุชูุจู ุงูุจุถุงุนุฉ ูู ุงูุดุฑูุฉ ุงูุฃู.

## ๐ ุงูุณููุงุฑูู ุงูุตุญูุญ:
```
1. ุงููุณุชุฎุฏู (ูุซูุงู: ูุฏูุฑ ุงููุธุงู)
2. ูุฎุชุงุฑ ุงูุดุฑูุฉ ุงูุฃู (ูุซูุงู: ุดุฑูุฉ ุงูุชูุงุฒู) โ ุงููุตุฏุฑ
3. ูุฎุชุงุฑ ุงูุดุฑูุฉ ุงููุฑุนูุฉ (ูุซูุงู: ุดุฑูุฉ ุงูุฅูุงุฑุงุช) โ ุงููุณุชููุฉ
4. ูุฎุชุงุฑ ุงูุนููู
5. ูุถูู ุงูุจููุฏ
6. ููุดุฆ ุงูุนูููุฉ

ุงููุชูุฌุฉ:
- ูุงุชูุฑุฉ ุขุฌู ูู ุงูุชูุงุฒู โ ุงูุฅูุงุฑุงุช
- ูุงุชูุฑุฉ ููุนููู ูู ุงูุฅูุงุฑุงุช โ ุงูุนููู
```

---

## ๐ง ุงูุชุญุฏูุซุงุช ุงููุทุจูุฉ:

### 1. **ุฅุถุงูุฉ State ููุดุฑูุฉ ุงููุฑุนูุฉ**:
```typescript
const [selectedBranchCompany, setSelectedBranchCompany] = useState<number | undefined>(undefined);
```

### 2. **ููุชุฑุฉ ุงูุดุฑูุงุช ุงููุฑุนูุฉ**:
```typescript
const branchCompanies = companiesData?.data?.companies?.filter(company => 
  company.isParent === false && company.parentId !== null
) || [];
```

### 3. **ุชุญุฏูุซ Validation**:
```typescript
// ุฅุฒุงูุฉ ุงูุชุญูู ูู currentCompanyId
// ุฅุถุงูุฉ ุงูุชุญูู ูู selectedBranchCompany
if (!selectedBranchCompany) {
  error('ุฎุทุฃ', 'ูุฌุจ ุงุฎุชูุงุฑ ุงูุดุฑูุฉ ุงููุฑุนูุฉ');
  return;
}
```

### 4. **ุชุญุฏูุซ Request Data**:
```typescript
const requestData = {
  customerId: selectedCustomer,
  branchCompanyId: selectedBranchCompany,  // โ ูู ุงูุงุฎุชูุงุฑ
  parentCompanyId: selectedParentCompany,
  lines: lines,
  profitMargin: profitMargin,
  customerSaleType: customerSaleType,
  customerPaymentMethod: customerPaymentMethod
};
```

### 5. **ุฅุถุงูุฉ ุญูู ูู UI**:
```tsx
<div>
  <label className="block text-sm font-medium text-slate-700 mb-2">
    ุงูุดุฑูุฉ ุงููุฑุนูุฉ (ุงููุณุชููุฉ) *
  </label>
  <select
    value={selectedBranchCompany || ''}
    onChange={(e) => setSelectedBranchCompany(Number(e.target.value) || undefined)}
    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
    required
  >
    <option value="">ุงุฎุชุฑ ุงูุดุฑูุฉ ุงููุฑุนูุฉ</option>
    {branchCompanies.map((company) => (
      <option key={company.id} value={company.id}>
        {company.name}
      </option>
    ))}
  </select>
</div>
```

### 6. **ุชุญุฏูุซ Reset**:
```typescript
setSelectedBranchCompany(undefined);
```

---

## ๐จ ุงูุชุตููู ุงูุฌุฏูุฏ:

### ุงูุญููู ุจุงูุชุฑุชูุจ:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุงูุนููู *                                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุงูุดุฑูุฉ ุงููุฑุนูุฉ (ุงููุณุชููุฉ) *  โ ุฌุฏูุฏ       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุงูุดุฑูุฉ ุงูุฃู (ุงููุตุฏุฑ) *                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ูุงูุด ุงูุฑุจุญ (%)                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โ ุงูููุงุฆุฏ:

### 1. **ูุฑููุฉ ูุงููุฉ**:
- ูุณุชุฎุฏู ุงููุธุงู ููููู ุฅูุดุงุก ุนูููุงุช ูุฃู ุดุฑูุฉ ูุฑุนูุฉ
- ูุง ููุชุตุฑ ุนูู ุดุฑูุฉ ุงููุณุชุฎุฏู ุงูุญุงูู

### 2. **ูุถูุญ ุฃูุจุฑ**:
- "ุงูุดุฑูุฉ ุงููุฑุนูุฉ (ุงููุณุชููุฉ)" - ูุงุถุญ ุฃููุง ุชุณุชูุจู ุงูุจุถุงุนุฉ
- "ุงูุดุฑูุฉ ุงูุฃู (ุงููุตุฏุฑ)" - ูุงุถุญ ุฃููุง ูุตุฏุฑ ุงูุจุถุงุนุฉ

### 3. **ุชุญูู ุฃูุถู**:
- ูููู ูููุฏูุฑ ุฅูุดุงุก ุนูููุงุช ุจูู ุฃู ุดุฑูุฉ ุฃู ููุฑุน
- ุฏุนู ูุงูู ููุณุชุฎุฏูู ุงููุธุงู

### 4. **Validation ูุญุณู**:
- ุงูุชุญูู ูู ุงุฎุชูุงุฑ ุงูุดุฑูุฉ ุงููุฑุนูุฉ
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ

---

## ๐ ูุซุงู ุนูู ุงูุงุณุชุฎุฏุงู:

### ุงูุณููุงุฑูู:
```
ุงููุณุชุฎุฏู: admin (System User)
ูุฑูุฏ ุฅูุดุงุก ุนูููุฉ ุจูุน:
  - ูู: ุดุฑูุฉ ุงูุชูุงุฒู (ุงูุฃู)
  - ุฅูู: ุดุฑูุฉ ุงูุฅูุงุฑุงุช (ุงููุฑุน)
  - ููุนููู: ูุญูุฏ ุฃุญูุฏ
```

### ุงูุฎุทูุงุช:
1. โ ุงุฎุชูุงุฑ ุงูุนููู: ูุญูุฏ ุฃุญูุฏ
2. โ ุงุฎุชูุงุฑ ุงูุดุฑูุฉ ุงููุฑุนูุฉ: ุดุฑูุฉ ุงูุฅูุงุฑุงุช
3. โ ุงุฎุชูุงุฑ ุงูุดุฑูุฉ ุงูุฃู: ุดุฑูุฉ ุงูุชูุงุฒู
4. โ ุชุญุฏูุฏ ูุงูุด ุงูุฑุจุญ: 20%
5. โ ุงุฎุชูุงุฑ ููุน ุงููุงุชูุฑุฉ: ููุฏู
6. โ ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุฏูุน: ูุงุด
7. โ ุฅุถุงูุฉ ุงูุจููุฏ
8. โ ุฅูุดุงุก ุงูุนูููุฉ

### ุงููุชูุฌุฉ:
- โ ูุงุชูุฑุฉ ุขุฌู ูู ุงูุชูุงุฒู โ ุงูุฅูุงุฑุงุช
- โ ูุงุชูุฑุฉ ููุฏูุฉ ูู ุงูุฅูุงุฑุงุช โ ูุญูุฏ ุฃุญูุฏ
- โ ุฎุตู ุงููุฎุฒูู ูู ุงูุชูุงุฒู

---

## ๐ ุงููููุงุช ุงููุญุฏุซุฉ:

### Frontend:
1. โ `/client/src/app/complex-inter-company-sales/page.tsx`
   - ุฅุถุงูุฉ state ููุดุฑูุฉ ุงููุฑุนูุฉ
   - ุฅุถุงูุฉ ููุชุฑุฉ ููุดุฑูุงุช ุงููุฑุนูุฉ
   - ุฅุถุงูุฉ ุญูู ุงุฎุชูุงุฑ ูู UI
   - ุชุญุฏูุซ validation
   - ุชุญุฏูุซ request data

### Backend:
- ูุง ุญุงุฌุฉ ูุชุญุฏูุซ - ุงูุจุงู ุฅูุฏ ูุณุชูุจู `branchCompanyId` ุจุงููุนู

---

## ๐งช ุงูุงุฎุชุจุงุฑ:

### 1. ุชุณุฌูู ุงูุฏุฎูู ูู System User:
```
Username: admin
Password: admin123
```

### 2. ุงูุฐูุงุจ ูุดุงุดุฉ ุงููุจูุนุงุช ุงููุนูุฏุฉ:
```
/complex-inter-company-sales
```

### 3. ุฅูุดุงุก ุนูููุฉ ุฌุฏูุฏุฉ:
- ุงุฎุชุฑ ุงูุนููู
- ุงุฎุชุฑ ุงูุดุฑูุฉ ุงููุฑุนูุฉ (ูุซูุงู: ุดุฑูุฉ ุงูุฅูุงุฑุงุช)
- ุงุฎุชุฑ ุงูุดุฑูุฉ ุงูุฃู (ูุซูุงู: ุดุฑูุฉ ุงูุชูุงุฒู)
- ุฃุถู ุงูุจููุฏ
- ุงุญูุธ

### 4. ุงูุชุญูู:
- โ ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ ูุฌุงุญ
- โ ูุฌุจ ุฅูุดุงุก ูุงุชูุฑุชูู (ุขุฌู + ููุฏู/ุขุฌู)
- โ ูุฌุจ ุฎุตู ุงููุฎุฒูู ูู ุงูุดุฑูุฉ ุงูุฃู

---

## โจ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:

ุงููุธุงู ุงูุขู ูุฏุนู:
- โ ุงุฎุชูุงุฑ ุงูุดุฑูุฉ ุงููุฑุนูุฉ ุงููุณุชููุฉ
- โ ุงุฎุชูุงุฑ ุงูุดุฑูุฉ ุงูุฃู ุงููุตุฏุฑุฉ
- โ ููุน ูุงุชูุฑุฉ ุงูุนููู (ููุฏู/ุขุฌู)
- โ ุทุฑููุฉ ุงูุฏูุน (ูุงุด/ุญูุงูุฉ/ุจุทุงูุฉ)
- โ ูุงูุด ุงูุฑุจุญ ุงููุฑู
- โ validation ุดุงูู
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ

**ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุจุงููุงูู!** ๐
