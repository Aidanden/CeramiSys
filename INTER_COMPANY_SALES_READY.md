# โ ูุธุงู ุงููุจูุนุงุช ุจูู ุงูุดุฑูุงุช ุฌุงูุฒ!

## ๐ ุชู ุฅูุฌุงุฒ Backend ุจุงููุงูู!

### โ ูุง ุชู ุฅูุฌุงุฒู:

#### 1. **Backend (Server)** โ
- โ **DTOs**: `/server/src/dto/interCompanySaleDto.ts`
  - CreateInterCompanySaleDto
  - GetInterCompanySalesQueryDto
  
- โ **Service**: `/server/src/services/InterCompanySaleService.ts`
  - createInterCompanySale() - ุฅูุดุงุก ูุงุชูุฑุฉ ูุจูุนุงุช ุจูู ุงูุดุฑูุงุช
  - getInterCompanySales() - ุฌูุจ ุฌููุน ุงููุจูุนุงุช
  - getInterCompanySaleById() - ุชูุงุตูู ูุงุชูุฑุฉ ูุญุฏุฏุฉ
  - getInterCompanySalesStats() - ุงูุฅุญุตุงุฆูุงุช
  
- โ **Controller**: `/server/src/controllers/InterCompanySaleController.ts`
  - ูุนุงูุฌุฉ ุฌููุน ุงูุทูุจุงุช HTTP
  - ุงูุชุญูู ูู ุงููุตุงุฏูุฉ
  - ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
  
- โ **Routes**: `/server/src/routes/interCompanySaleRoutes.ts`
  ```
  POST   /api/inter-company-sales
  GET    /api/inter-company-sales
  GET    /api/inter-company-sales/stats
  GET    /api/inter-company-sales/:id
  ```
  
- โ **Integration**: ุชู ุฅุถุงูุฉ Routes ุฅูู `/server/src/index.ts`

---

#### 2. **Frontend API** โ
- โ **API**: `/client/src/state/interCompanySalesApi.ts`
  - useCreateInterCompanySaleMutation
  - useGetInterCompanySalesQuery
  - useGetInterCompanySaleByIdQuery
  - useGetInterCompanySalesStatsQuery
  
- โ **Redux**: ุชู ุฅุถุงูุฉ API ุฅูู `/client/src/app/redux.tsx`
  - Reducer
  - Middleware
  - Store integration

---

#### 3. **ุงูุณุงูุฏ ุจุงุฑ** โ
- โ ุชู ุฅุถุงูุฉ ุฑุงุจุท "ูุจูุนุงุช ุจูู ุงูุดุฑูุงุช" ูู `/client/src/app/(components)/Sidebar/index.tsx`
- โ ุงูุฃููููุฉ: ArrowRightLeft (ุณูููู ูุชูุงุจููู)
- โ ุงููุณุงุฑ: `/inter-company-sales`
- โ ุงููููุน: ุจูู "ุงููุจูุนุงุช ุงูุขุฌูุฉ" ู "ุงููุดุชุฑูุงุช"

---

## ๐ฏ ููู ูุนูู ุงููุธุงู:

### ุงูุณููุงุฑูู ุงููุงูู:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. ุงูุดุฑูุฉ ุงูุชุงุจุนุฉ ุชุฎุชุงุฑ ุฃุตูุงู ูู ุงูุดุฑูุฉ ุงูุฃู              โ
โ     - ุชุญุฏุฏ ุงููููุฉ ุงููุทููุจุฉ                                  โ
โ     - ุชุถูู ูุงูุด ุฑุจุญ ุนูู ุณุนุฑ ุงูุดุฑูุฉ ุงูุฃู                   โ
โ     - ุชุฎุชุงุฑ ุงูุนููู ุงูููุงุฆู                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  2. ุงููุธุงู ูุชุญูู ูู:                                        โ
โ     โ ุงูุดุฑูุฉ ุงูุชุงุจุนุฉ ููุง ุดุฑูุฉ ุฃู                          โ
โ     โ ุงููุฎุฒูู ูุชููุฑ ูู ุงูุดุฑูุฉ ุงูุฃู                        โ
โ     โ ุงูุจูุงูุงุช ุตุญูุญุฉ ูููุชููุฉ                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  3. Transaction (ุนูููุฉ ูุงุญุฏุฉ ูุชูุงููุฉ):                     โ
โ     โ ุฅูุดุงุก ูุงุชูุฑุฉ ุจูุน ููุนููู (Sale)                     โ
โ     โ ุฅูุดุงุก ูุงุชูุฑุฉ ุดุฑุงุก ุขุฌูุฉ (PurchaseFromParent)        โ
โ     โ ุฎุตู ุงููุฎุฒูู ูู ุงูุดุฑูุฉ ุงูุฃู (Stock)                 โ
โ     โ ุญุณุงุจ ูุงูุด ุงูุฑุจุญ ุชููุงุฆูุงู                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  4. ุงููุชูุฌุฉ:                                                โ
โ     ๐ ูุงุชูุฑุฉ ุจูุน ููุนููู (ุจุณุนุฑ ุงููุฑุน)                     โ
โ     ๐ ูุงุชูุฑุฉ ุดุฑุงุก ุขุฌูุฉ ูู ุงูุดุฑูุฉ ุงูุฃู (ุจุณุนุฑ ุงูุฃู)        โ
โ     ๐ฆ ูุฎุฒูู ุงูุดุฑูุฉ ุงูุฃู ูุฎุตูู                             โ
โ     ๐ฐ ูุงูุด ุงูุฑุจุญ ูุญุณูุจ ููุณุฌู                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ฐ ูุซุงู ุนููู:

### ุงูุจูุงูุงุช:
- **ุงูุตูู**: ุจูุงุท ุณูุฑุงููู
- **ุงููููุฉ**: 10 ุตูุงุฏูู
- **ุณุนุฑ ุงูุดุฑูุฉ ุงูุฃู**: 50 ุฏ.ู/ุตูุฏูู
- **ุณุนุฑ ุงููุฑุน**: 60 ุฏ.ู/ุตูุฏูู

### ุงูุญุณุงุจุงุช:
```
ุฅุฌูุงูู ูุงุชูุฑุฉ ุงูุนููู (ุงูุฅูุฑุงุฏุงุช):
10 ร 60 = 600 ุฏ.ู

ุฅุฌูุงูู ูุงุชูุฑุฉ ุงูุดุฑูุฉ ุงูุฃู (ุงูุชูููุฉ):
10 ร 50 = 500 ุฏ.ู

ูุงูุด ุงูุฑุจุญ:
600 - 500 = 100 ุฏ.ู

ูุณุจุฉ ูุงูุด ุงูุฑุจุญ:
(100 / 600) ร 100 = 16.67%
```

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงููุชููุฑุฉ:

1. **ุฅุฌูุงูู ุงููุจูุนุงุช**: ุนุฏุฏ ุงูููุงุชูุฑ
2. **ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช**: ูุฌููุน ููุงุชูุฑ ุงูุนููุงุก
3. **ุฅุฌูุงูู ุงูุชูููุฉ**: ูุฌููุน ููุงุชูุฑ ุงูุดุฑูุฉ ุงูุฃู
4. **ุฅุฌูุงูู ุงูุฑุจุญ**: ุงูุฅูุฑุงุฏุงุช - ุงูุชูููุฉ
5. **ูุณุจุฉ ูุงูุด ุงูุฑุจุญ**: (ุงูุฑุจุญ / ุงูุฅูุฑุงุฏุงุช) ร 100
6. **ุงููุจูุนุงุช ุงูููุฏูุฉ**: ุนุฏุฏ ุงูููุงุชูุฑ ุงูููุฏูุฉ
7. **ุงููุจูุนุงุช ุงูุขุฌูุฉ**: ุนุฏุฏ ุงูููุงุชูุฑ ุงูุขุฌูุฉ

---

## ๐ ุงูุฃูุงู:

### 1. ุงูุชุญูู ูู ุงูุดุฑูุฉ ุงูุชุงุจุนุฉ:
```typescript
if (!branchCompany?.parentId) {
  throw new Error('ูุฐู ุงูุดุฑูุฉ ููุณุช ุดุฑูุฉ ุชุงุจุนุฉ');
}
```

### 2. ุงูุชุญูู ูู ุงููุฎุฒูู:
```typescript
if (Number(stock.boxes) < line.qty) {
  throw new Error('ุงููุฎุฒูู ุบูุฑ ูุงูู');
}
```

### 3. Transaction ููุญูุงุธ ุนูู ุชูุงูู ุงูุจูุงูุงุช:
- ุฅุฐุง ูุดูุช ุฃู ุนูููุฉุ ูุชู ุงูุชุฑุงุฌุน ุนู ุงููู
- ูุง ูููู ุฃู ุชููุดุฃ ูุงุชูุฑุฉ ุจุฏูู ุงูุฃุฎุฑู
- ุงููุฎุฒูู ูุง ููุฎุตู ุฅูุง ุฅุฐุง ูุฌุญุช ุฌููุน ุงูุนูููุงุช

---

## ๐ ุงูุฎุทูุฉ ุงูุชุงููุฉ:

### ุฅูุดุงุก ุตูุญุฉ Frontend:

**ุงููุทููุจ**:
1. **ุตูุญุฉ `/inter-company-sales`** ุชุญุชูู ุนูู:
   - ๐ ุจุทุงูุงุช ุงูุฅุญุตุงุฆูุงุช (4 ุจุทุงูุงุช)
   - ๐ ููุงุชุฑ ุงูุจุญุซ ูุงูุชุตููุฉ
   - ๐ ุฌุฏูู ุนุฑุถ ุงูููุงุชูุฑ
   - โ ุฒุฑ ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ

2. **ููุฏุงู ุฅูุดุงุก ูุงุชูุฑุฉ** ูุญุชูู ุนูู:
   - ุงุฎุชูุงุฑ ุงูุนููู
   - ููุน ุงูุจูุน (ููุฏู/ุขุฌู)
   - ุทุฑููุฉ ุงูุฏูุน (ููููุฏู)
   - ุฌุฏูู ุงูุฃุตูุงู:
     - ุงุฎุชูุงุฑ ุงูุตูู ูู ุงูุดุฑูุฉ ุงูุฃู
     - ุงููููุฉ
     - ุณุนุฑ ุงูุดุฑูุฉ ุงูุฃู (ูููุฑุงุกุฉ ููุท)
     - ุณุนุฑ ุงููุฑุน (ูุงุจู ููุชุนุฏูู)
     - ุงูุฅุฌูุงูู ุงููุฑุนู
   - ุนุฑุถ ุงูุฅุฌูุงููุงุช:
     - ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช
     - ุฅุฌูุงูู ุงูุชูููุฉ
     - ูุงูุด ุงูุฑุจุญ
     - ูุณุจุฉ ูุงูุด ุงูุฑุจุญ

3. **ููุฏุงู ุชูุงุตูู ุงููุงุชูุฑุฉ** ูุญุชูู ุนูู:
   - ุชูุงุตูู ูุงุชูุฑุฉ ุงูุจูุน
   - ุชูุงุตูู ูุงุชูุฑุฉ ุงูุดุฑุงุก
   - ูุงูุด ุงูุฑุจุญ
   - ุงูุฃุตูุงู ุงููุจุงุนุฉ

---

## ๐ ุงููููุงุช ุงูููุฌูุฏุฉ:

### Backend:
- โ `/server/src/dto/interCompanySaleDto.ts`
- โ `/server/src/services/InterCompanySaleService.ts`
- โ `/server/src/controllers/InterCompanySaleController.ts`
- โ `/server/src/routes/interCompanySaleRoutes.ts`
- โ `/server/src/index.ts` (ูุญุฏุซ)

### Frontend:
- โ `/client/src/state/interCompanySalesApi.ts`
- โ `/client/src/app/redux.tsx` (ูุญุฏุซ)
- โ `/client/src/app/(components)/Sidebar/index.tsx` (ูุญุฏุซ)
- โณ `/client/src/app/inter-company-sales/page.tsx` (ุงููุทููุจ ุฅูุดุงุคู)

### ุงูุชูุซูู:
- โ `/INTER_COMPANY_SALES_SYSTEM.md` - ุงูุชูุซูู ุงููุงูู
- โ `/INTER_COMPANY_SALES_READY.md` - ูุฐุง ุงูููู

---

## ๐จ ุชุตููู ุงูุตูุญุฉ ุงูููุชุฑุญ:

### 1. ุจุทุงูุงุช ุงูุฅุญุตุงุฆูุงุช (4 ุจุทุงูุงุช):
```
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโ
โ ๐ ุฅุฌูุงูู   โ ๐ฐ ุงูุฅูุฑุงุฏุงุช โ ๐ต ุงูุชูููุฉ  โ ๐ ุงูุฑุจุญ     โ
โ ุงููุจูุนุงุช    โ              โ              โ              โ
โ 25 ูุงุชูุฑุฉ   โ 15,000 ุฏ.ู  โ 12,000 ุฏ.ู  โ 3,000 ุฏ.ู   โ
โ              โ              โ              โ 20% ูุงูุด    โ
โโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโ
```

### 2. ุงูููุงุชุฑ:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ ุงูุจุญุซ: [___________]  ๐ ูู: [____] ุฅูู: [____]    โ
โ ๐ค ุงูุนููู: [ุงุฎุชุฑ]  ๐ณ ุงูููุน: [ุงููู โผ]                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 3. ุงูุฌุฏูู:
```
โโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโ
โ #  โ ุงููุงุชูุฑุฉโ ุงูุนููู โ ุงูุชุงุฑูุฎ โ ุงูุฅูุฑุงุฏุงุชโ ุงูุชูููุฉโ ุงูุฑุจุญ  โ ุฅุฌุฑุงุกุงุชโ
โโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโผโโโโโโโโโค
โ 1  โ BR-001 โ ูุญูุฏ   โ 01/10   โ 600 ุฏ.ูโ 500 ุฏ.ูโ 100 ุฏ.ูโ ๐๏ธ ๐จ๏ธ โ
โโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโโโโดโโโโโโโโโ
```

---

## โ ุงูุฎูุงุตุฉ:

**Backend ุฌุงูุฒ 100%! ๐**

- โ ุฌููุน ุงูู APIs ุชุนูู
- โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฌุงูุฒุฉ
- โ ุงูุฃูุงู ูุทุจู
- โ Transaction ููุญูุงุธ ุนูู ุงูุชูุงูู
- โ Redux integration ูุงูู
- โ ุงูุณุงูุฏ ุจุงุฑ ูุญุฏุซ

**ุงููุชุจูู**: ุฅูุดุงุก ุตูุญุฉ Frontend ููุท! ๐

---

**ุฌุงูุฒ ูุจุฏุก ุชุทููุฑ ุงููุงุฌูุฉ ุงูุฃูุงููุฉ! ๐ช**
